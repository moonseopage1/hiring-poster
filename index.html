<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poster Generator</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>

<body>

    <div class="control-container">
        <div class="controls">
            <input type="text" id="jobTitleInput" placeholder="Enter Job Title">
            <button id="generateBtn">Generate Posters</button>
            <button id="downloadAllBtn" style="display:none;">Download ZIP</button>
        </div>
    </div>

    <div class="poster-container" id="posterContainer"></div>

    <script>
        const generateBtn = document.getElementById("generateBtn");
        const downloadAllBtn = document.getElementById("downloadAllBtn");
        const posterContainer = document.getElementById("posterContainer");

        const imageUrls = [
            './assets/Hiring-1.png',
            './assets/Hiring-2.png',
            './assets/Hiring-3.png',
            './assets/Hiring-4.png',
            './assets/Hiring-6.png',
            './assets/Hiring-10.png',
            './assets/Hiring-7.png',
            './assets/Hiring-8.png',
            './assets/Hiring-9.png',
            './assets/Hiring-11.png',
            './assets/Hiring-5.png',
        ];

        generateBtn.addEventListener("click", () => {
            const jobTitle = document.getElementById("jobTitleInput").value.trim();
            posterContainer.innerHTML = "";

            if (!jobTitle) {
                alert("Please enter a job title.");
                return;
            }

            imageUrls.forEach((imageURL, index) => {
                const direction = getDirection(index);

                const uploadedImage = document.createElement("div");
                uploadedImage.classList.add("uploaded-image");
                uploadedImage.style.backgroundImage = `url(${imageURL})`;
                uploadedImage.style.position = "relative";

                const overlay = document.createElement("div");
                overlay.classList.add(direction);

                overlay.innerHTML = `
      <div class="overlayTemplate">
        <h4 class="weAre">We're</h4>
        <h1 class="hiring">HiRING!</h1>
        <p class="jobTitle">${jobTitle}</p>
      </div>
    `;

                uploadedImage.appendChild(overlay);
                posterContainer.appendChild(uploadedImage);
            });

            downloadAllBtn.style.display = "inline-block";
        });

        downloadAllBtn.addEventListener("click", async () => {
            const posters = document.querySelectorAll(".uploaded-image");
            if (!posters.length) return;

            const zip = new JSZip();

            for (let i = 0; i < posters.length; i++) {
                const poster = posters[i];
                const canvas = await html2canvas(poster);
                const blob = await new Promise(resolve => canvas.toBlob(resolve, "image/png"));
                zip.file(`poster-${i + 1}.png`, blob);
            }

            zip.generateAsync({ type: "blob" }).then(content => {
                const link = document.createElement("a");
                link.href = URL.createObjectURL(content);
                link.download = "posters.zip";
                link.click();
            });
        });

        function getDirection(index) {
            if (index < 6) return "overlay";
            if (index < 10) return "overlay-left";
            return "top-left";
        }
    </script>

</body>

</html>